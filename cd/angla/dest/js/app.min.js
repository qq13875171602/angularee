!function(e){var o=angular.module("myapp",["ngRoute","ngCookies","controllers","directives","services"]);angular.module("controllers",[]),angular.module("directives",[]),angular.module("services",[]),o.config(["$logProvider",function(e){e.debugEnabled(!0)}]),o.config(["$httpProvider",function(e){e.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=utf-8";var s=function(e){var o,t,a,n,i,l,d="";for(o in e)if((t=e[o])instanceof Array)for(l=0;l<t.length;l++)n=t[l],(i={})[o+"["+l+"]"]=n,d+=s(i)+"&";else if(t instanceof Object)for(a in t)n=t[a],(i={})[o+"."+a]=n,d+=s(i)+"&";else null!=t&&(d+=encodeURIComponent(o)+"="+encodeURIComponent(t)+"&");return d.length?d.substr(0,d.length-1):d};e.defaults.transformRequest=[function(e){return angular.isObject(e)&&"[object File]"!==String(e)?s(e):e}]}]),o.config(["$routeProvider",function(e){e.when("/",{redirectTo:"html/user/user.html"}).when("/admin",{templateUrl:"html/user/admin/admin.html"}).when("/zhuce",{templateUrl:"html/user/zhuce/zhuce.html"}).when("/denglu",{templateUrl:"html/user/denglu/denglu.html"}).when("/yemian",{templateUrl:"html/user/houtai/yemian.html"}).when("/bokeTypeAdd",{templateUrl:"html/user/houtai/bokeTypeAdd.html"}).when("/book",{templateUrl:"html/user/houtai/book.html"}).when("/index.debug",{templateUrl:"/index.debug.html"}).otherwise({templateUrl:"html/user/user.html"})}])}(window),angular.element(document).ready(function(){angular.module("myapp").run(["$rootScope","$log",function(e,o){o.info("测试模块"),e.title="网站项目"}]),angular.bootstrap(document,["myapp"])}),angular.module("controllers").controller("rootctol",["$log","$scope","$rootScope","datahttp",function e(a,o,t,n){a.debug("rootctol.....",e),n.logint(),o.$on("$destroy",function(){a.debug("销毁控制器")}),t.$on("$routeChangeStart",function(e,o,t){a.debug("rout加载页面",o,"-",t,"-",e)}),t.$on("$routeChangeSuccess",function(e,o,t){a.debug("rout加载完毕",o,"-",t,"-",e)}),t.$on("$routeChangeError",function(e,o){a.debug("route加载错误",o,"-",e)})}]),angular.module("controllers").controller("routrol",["$log","$scope","$routeParams",function(o,t,a){o.debug("routrol..."),t.$on("$destroy",function(){o.debug("控制器销毁")});var n="path/";t.init=function(){var e=a.path().replace(n,"");o.debug("paths",e),t.temple="user/path/.html?pagetime"+(new Date).getTime(),o.debug("routrol temple",t.temple)},t.init()}]),function(){var e=angular.module("directives");e.directive("aletDialog",["$log","Dataservice",function(a,n){return{restrict:"AE",template:"<div class='modal' style='z-index:1900;' role='dialog' tabindex='-1' data-backgrop='static' data-keyborad='false' >                 <div class='modal-dialog'>                      <div class='modal-content'>                       <div class='modal-header'>              <button type='button' class='close' data-dismiss='modal' aria-label='Close' >&times;</button>                      <span class='modal-title' ng-bind='atitle'></span>          </div>                          <div class='modal-body'>                 <span ng-bind='infos'></span>          </div>                    <div class='modal-footer'>           <button type='button' data-dismiss='modal' class='btn btn-primary' ng-bind='btnok'></button>     </div>       </div    </div>     </div>",replace:!0,link:function(e,o,t){e.$on("$destroy",function(){a.debug("销毁控制器")}),a.debug("aldiog",o),n.artDalog({scope:e,element:o})}}}]);e.directive("warDialog",["$log","Dataservice",function(a,n){return{restrict:"AE",template:"<div class='modal' role='dialog' data-backgrop='static' tabindex='-1' data-keyborad='false' style='z-index:1995'>     <div class='modal-dialog'>       <div class='modal-content'>             <div class='modal-header'>        <button type='button' class='close' data-dismiss='modal' aria-label='Close' >&times;</button>      <span  ng-bind='otitle'></span>                           </div>          <div class='modal-body'>     <span ng-bind='poinfo'></span>         </div>                                                                                 </div>                    </div>                        </div>",replace:!0,link:function(e,o,t){e.$on("$destroy",function(){a.debug("控制器销毁")}),a.debug("warDialog",o),n.warldaloh({scope:e,element:o})}}}]);e.directive("setqwDialog",["$log","Dataservice",function(a,n){return{restrict:"AE",template:"<div class='modal' role='dialog' data-backgrop='static' tabindex='-1' data-keyborad='false' style='z-index:1998'>     <div class='modal-dialog'>    <div class='modal-content'>      <div class='modal-header'>           <button type='button' class='close' data-dismiss='modal'  aria-label='Close'>&times;</button>        <span  ng-bind='titlesad'></span>                                       </div>                 <div class='modal-body'>    <span ng-bind='qwinfo'></span>     </div>                  <div class='modal-footer'>     <button type='button' data-dismiss='modal' class='btn btn-primary' ng-click='comlp()'  ng-bind='mjbynok'></button>        <button type='button' data-misdiss='modal' class='btn btn-info' ng-click='nolkp()' ng-bind='qnok' ></button>                                  </div>                                           </div>                                     </div>                        </div>",replace:!0,link:function(e,o,t){e.$on("$destroy",function(){a.debug("控制器销毁")}),a.debug("setqwDialog",o),n.setqwpdiao({scope:e,element:o}),e.comlp=n.tyshg,e.nolkp=n.sacha}}}]);e.directive("customDialog",["$log","Dataservice",function(a,n){return a.debug("directive custom-dialog..."),{restrict:"AE",template:"<div class='modal' data-backdrop='static' data-keyboard='false' tabindex='-1' role='dialog' style='z-index: 1500;'>    <div class='modal-dialog' role='document'>        <div class='modal-content'>            <div class='modal-header'>    <button type='button' class='close' data-dismiss='modal'  aria-label='Close'>&times;</button>            <div class='modal-title' ng-bind='customTitle'></div>            </div>            <div class='modal-body'>                <div ng-include='customPage'></div>            </div>        </div>    </div></div>",replace:!0,link:function(e,o,t){e.$on("$destroy",function(){a.debug("directive custom-dialog destroy...")}),a.debug("directive custom-dialog init==>",o),n.setCustomDialog({scope:e,element:o})}}}])}(),angular.module("services").factory("Dataservice",["$log","$timeout",function(a,n){a.debug("Dataservice"),service={};var i="图书管理",l=null;service.alttitle=function(e){l=e},service.temptitle=function(e){i=e};var t=null;service.tempbtnok=function(e){t=e};var d={huidiao:angular.noop,couhs:!1};service.artDalog=function(e){a.debug("Dataservice.artDalog",e),d.scope=e.scope,d.element=e.element,d.element.on("hidden.bs.modal",function(){var e=d.huidiao;d.huidiao=angular.noop,e()}),d.couhs=!0},service.setdialog=function(e,o){d.couhs&&n(function(){d.huidiao=o||angular.noop,d.scope.infos=e,d.scope.atitle=l||i,d.scope.btnok=t||"确认",l=t=null,d.element.modal("show")})},service.hidedialog=function(){d.element.modal("hide")};var s={huidiao:angular.noop,couhs:!1};service.warldaloh=function(e){a.debug("Dataservice.warldaloh",e),s.scope=e.scope,s.element=e.element,s.element.on("hidden.bs.modal",function(){var e=s.huidiao;s.huidiao=angular.noop,e()}),s.couhs=!0},service.wadlklog=function(e,o){s.couhs?n(function(){s.huidiao=o||angular.noop,s.scope.poinfo=e,s.scope.otitle=i||l,l=null,s.element.modal("show")}):a.debug("wadlklog")},service.hidewardialog=function(){s.element.modal("hide")};var u="确认",c="取消",r=null,g=null;service.pok=function(e){u=e},service.mnok=function(e){c=e},service.wsca=function(e){r=e},service.lpo=function(e){g=e};var m={yes:angular.nnop,lno:angular.noop,chons:"no",couhs:!1};service.setqwpdiao=function(e){a.debug("Dataservice.setqwpdiao",e),m.scope=e.scope,m.element=e.element,m.couhs=!0},service.awstdialog=function(e,o,t){m.couhs&&n(function(){m.yes=o||angular.noop,m.lno=t||angular.noop,m.scope.qwinfo=e,m.scope.titlesad=l||i,l=null,m.scope.mjbynok=u||r,r=null,m.scope.qnok=c||g,g=null,m.element.on("hidden.bs.modal",function(){var e="no"==m.chons?m.yes:m.lno;m.chons="no",m.yes=angular.noop,m.lno=angular.noop,e()}),m.element.modal("show")},4e3)},service.wqer=function(){m.element.modal("hide")},service.tyshg=function(){m.chons="yes",m.element.modal("hide")},service.sacha=function(){m.chons="no",m.element.modal("hide")};var p={closefn:angular.noop,hasinit:!1,data:{}};return service.setCustomDialog=function(e){a.debug("DialogService.setCustomDialog==>",e),p.scope=e.scope,p.element=e.element,p.element.on("hidden.bs.modal",function(){var e=p.closefn;p.closefn=angular.noop,e()}),p.hasinit=!0},service.showCustomDialog=function(e,o,t){p.hasinit?n(function(){p.scope.customPage=e,e="",p.data=o||{},p.closefn=t||angular.noop,p.scope.customTitle=l||i,l=null,p.element.modal("show")}):a.debug("DialogService.showCustomDialog not init...")},service.hideCustomDialog=function(){p.element.modal("hide")},service.getCustomData=function(){var e=p.data;return p.data={},e},service}]),angular.module("services").factory("datahttp",["$log","$http","$cookies","$window",function(a,n,i,o){var l=["http://localhost:1050","http://120.77.205.162:11000","http://127.0.0.1:11000"],d={},e={data:function(e,o,t){(d=i.get("token_key"))||(d=""),o.seiiontoken=d,o.ajaxtimestamp=(new Date).getTime(),a.debug("http service===>",l[2]+e),n({method:"POST",url:l[0]+e,data:o}).then(function(e){a.debug("正确信息",e.data),i.put("token_key",e.data.seiiontoken),(t||angular.noop)(null,e.data)},function(e){a.debug("错误信息",e),(t||angular.noop)(e,null)})}},r=["星期六","星期一","星期二","星期三","星期四","星期五","星期天"];return e.time=function(e,o){var t=new Date;e&&t.setTime(e),o||o("y-m-d");var a=t.getFullYear(),n=t.getMonth()+1,i=t.getDate(),l=t.getHours(),d=t.getMinutes(),s=t.getSeconds(),u=t.getDay();n=n<10?"0"+n:""+n,i=i<10?"0"+i:""+i,l=l<10?"0"+l:""+l,d=d<10?"0"+d:""+d,s=s<10?"0"+s:""+s,u=r[u];var c=o.replace("y",a);return c=(c=(c=(c=(c=(c=c.replace("m",n)).replace("d",i)).replace("h",l)).replace("i",d)).replace("s",s)).replace("w",u)},e.logint=function(e){o.localStorage.user=JSON.stringify(e),$rootScope.login=e},e.deletelogint=function(){delete o.localStorage.user,delete $rootScope.login},e.jiexi=function(){var e=o.localStorage.user;if(e)try{$rootScope.login=JSON.parse(e)}catch(e){console.log(e)}},e}]),angular.module("controllers").controller("conpl",["$log","$scope","$location","datahttp","$rootScope","$window","Dataservice",function(e,o,t,a,n,i,l){e.debug("conpl"),o.$on("$destroy",function(){e.debug("销毁控制器")}),o.data={},n.name={},o.denglu=function(){l.wadlklog("正在登录中"),a.data("/data/Tbuse/queryo",o.data,function(e,o){if(l.hidewardialog(),!e)return o.success?(l.setdialog("登录成功"),n.name=o.dataMap.tbuser,void t.path("/yemian")):void l.setdialog(o.message);l.setdialog("服务器正忙")})},o.plo=function(){o.data={}}}]),angular.module("controllers").controller("tuichu",["$scope","$log","$location","datahttp","Dataservice",function(e,o,t,a){o.debug("tuichu..."),e.$on("$destroy",function(){o.debug("销毁控制器")}),e.close=function(){Dataservice.setdialog("正在退出中"),a.deletelogint(),a.data("/denglu/Index",{},function(e,o){Dataservice.hidedialog(),t.path("/denglu.html")})}}]),angular.module("controllers").controller("plk",["$log","$scope","datahttp","$rootScope","Dataservice",function(t,a,n,i,l){t.debug("plk"),a.$on("$destroy",function(){t.debug("销毁控制器")}),a.op=!0,a.bn=!0,a.like={},a.shuju={},a.query={},a.mohu={},a.lick=function(){a.op=!1},a.ke=function(){a.op=!0},a.zx=function(){a.bn=!1},a.cv=function(){a.bn=!0},a.add=function(){l.wadlklog("正在进入中"),n.data("/date/message/add",a.shuju,function(e,o){if(l.hidewardialog(),e)return l.setdialog("服务器正忙"),void t.debug("err",e);o.success?l.setdialog("添加成功",function(){l.hidedialog()}):l.setdialog(o.message)})},a.ag=function(){l.wadlklog("正在进入中"),n.data("/date/message/query",{},function(e,o){if(l.hidewardialog(),!e)return o.success?(l.setdialog("查询成功"),void(a.pl=o.dataMap.list)):void l.setdialog(o.message);l.setdialog("服务器正忙")})},a.ag(),a.tianjia=function(){l.wadlklog("正在添加中"),n.data("/data/book/add",a.like,function(e,o){if(l.hidewardialog(),!e)return o.success?(l.setdialog("添加成功",function(){l.hidedialog()}),void a.okl()):void l.setdialog(o.message);l.setdialog("添加失败")})},a.okl=function(e,o){n.data("/data/book/query",{"page.pageSize":4,"page.pageNumber":1},function(e,o){if(!e)return o.success?(console.log("查询成功"),a.query=o.dataMap.list,void(a.page=o.dataMap.page)):void 0;console.log("查询失败")})},a.okl(),a.sd=function(e){n.data("/data/book/query",{"page.pageSize":4,"page.pageNumber":e},function(e,o){if(!e)return o.success?(console.log("查询成功"),a.query=o.dataMap.list,void(a.page=o.dataMap.page)):void 0;console.log("查询失败")})},a.qw=function(e){n.data("/data/book/query",{"page.pageSize":4,"page.pageNumber":e},function(e,o){if(!e)return o.success?(console.log("查询成功"),a.query=o.dataMap.list,void(a.page=o.dataMap.page)):void 0;console.log("查询失败")})},a.ty=function(e){n.data("/houtai/select",{"page.PageSize":4,"page.PageNumber":e},function(e,o){if(!e)return o.Souse?(console.log("查询成功"),a.query=o.list,void(a.page=o.page)):void 0;console.log("查询失败")})},a.delete=function(e){l.wadlklog("正在删除中"),n.data("/data/book/delete",{"book.bid":e},function(e,o){l.hidewardialog(),e?l.setdialog("服务器正忙"):o.success?l.setdialog("删除成功",function(){a.okl()}):l.setdialog(o.message)})},a.chaxunqw=function(e){n.data("/data/book/miss",{bid:e},function(e,o){return e?(l.setdialog("查询失败"),void t.debug(e)):o.success?(l.showCustomDialog("/html/user/houtai/xiugai.html"),void(i.nbgf=o.dataMap.type)):void l.setdialog(o.message)})},a.xuigai=function(e){l.wadlklog("正在修改中"),n.data("/data/book/update",{"book.bid":e,book:a.zbvc},function(e,o){if(l.hidewardialog(),!e)return o.success?(l.setdialog("修改成功",function(){l.hideCustomDialog()}),void a.okl()):void l.setdialog(o.message);l.setdialog("服务器正忙")})}}]),angular.module("controllers").controller("mask",["$log","$scope","Dataservice","datahttp",function(e,o,t,a){e.debug("controllers.mask"),o.$on("$destroy",function(){e.debug("控制器销毁")}),o.add=function(){t.wadlklog("正在加载中"),a.data("/QianAdd/Index",o.vb,function(e,o){t.hidewardialog(),e?t.setdialog("添加失败"):o.Souse&&t.setdialog("添加成功",function(){})})}}]),angular.module("controllers").controller("denglu",["$log","$scope","Dataservice",function(e,o,t){e.debug("controllers.denglu"),o.$on("$destroy",function(){e.debug("denglu,销毁控制台")}),o.add=function(){t.showCustomDialog("/html/user/qiantai/denglu.html")},o.zhuce=function(){t.showCustomDialog("/html/user/qiantai/zhuce.html")}}]),angular.module("controllers").controller("dengl",["$log","$scope","Dataservice","datahttp",function(e,o,t,a){e.debug("controller.dengl"),o.$on("$destroy",function(){e.debug("销毁控制器")}),o.po={},o.deng=function(){t.wadlklog("正在登录中"),a.data("/data/Tbuse/queryo",o.po,function(e,o){t.hidewardialog(),e?t.setdialog("登录失败"):o.success?t.setdialog("登录成功",function(){t.hideCustomDialog()}):t.setdialog(o.message)})},o.chongzi=function(){o.po={}}}]),angular.module("controllers").controller("contr",["$scope","$log","datahttp","$location",function(e,o,t,a){o.debug("contr...."),e.$on("$destroy",function(){o.debug("销毁控制器")}),e.user={},e.dataas=function(){t.data("/zhuce/Index",e.user,function(e,o){e.Souse?console.log("添加成功"):err&&console.log("添加失败")})},e.kong=function(){e.user={}}}]);